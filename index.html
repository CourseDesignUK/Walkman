<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walkman WM-2 Player</title>
    <style>
        :root {
            --wm-metallic: #2d3436;
            --wm-silver: #7f8c8d;
            --wm-glass: rgba(20, 20, 25, 0.85);
            --wm-accent: #dcdde1;
            --orange-led: #ff4d00;
        }

        body {
            background-color: #121212;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }

        /* WM-2 Body Shape */
        .walkman-wm2 {
            height: 90vh;
            aspect-ratio: 10 / 15;
            background-color: var(--wm-metallic);
            border-radius: 12px;
            position: relative;
            box-shadow: 0 50px 100px rgba(0,0,0,0.8), inset 0 0 20px rgba(255,255,255,0.1);
            border: 2px solid #1a1a1a;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* The stepped silver top part of the WM-2 */
        .top-deck {
            height: 15%;
            background: linear-gradient(180deg, #444, #222);
            border-bottom: 4px solid #111;
            display: flex;
            align-items: center;
            padding-left: 20px;
        }

        .logo-w {
            color: var(--wm-accent);
            font-weight: bold;
            font-size: 3vh;
            letter-spacing: -2px;
        }

        /* Front Cassette Window */
        .window-frame {
            width: 75%;
            height: 40%;
            background: var(--wm-glass);
            margin: 20px auto;
            border: 8px solid #1a1a1a;
            border-radius: 4px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.9);
            position: relative;
        }

        .reel {
            width: 12vh;
            height: 12vh;
            background: #050505;
            border-radius: 50%;
            border: 4px dashed #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .reel::after {
            content: '';
            width: 20%; height: 20%;
            background: #222;
            transform: rotate(45deg);
        }

        .spinning { animation: rotate 3s linear infinite; }
        .spinning-fast { animation: rotate 0.6s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Iconic WM-2 Diagonal Control Panel */
        .button-cluster {
            position: absolute;
            bottom: 5%;
            right: 5%;
            width: 50%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            transform: rotate(-5deg); /* Subtle tilt common in Sony design */
        }

        .wm2-btn {
            background: #3d3d3d;
            border: 1px solid #111;
            color: #bdc3c7;
            padding: 15px 5px;
            font-size: 1vh;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.5);
            text-transform: uppercase;
        }

        .wm2-btn:active {
            background: #222;
            box-shadow: inset 2px 2px 5px black;
            transform: translate(1px, 1px);
        }

        .play-btn {
            grid-column: span 2;
            background: #444;
            height: 6vh;
            font-size: 1.5vh;
            border-top: 3px solid #666;
        }

        /* Operation LED */
        .led {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 8px;
            height: 8px;
            background: #300;
            border-radius: 50%;
        }
        .led-on {
            background: var(--orange-led);
            box-shadow: 0 0 10px var(--orange-led);
        }

        .eject-label {
            position: absolute;
            bottom: 5%;
            left: 10%;
            background: #c0392b;
            color: white;
            padding: 10px;
            font-size: 1vh;
            font-weight: bold;
            cursor: pointer;
            border-radius: 2px;
        }

        #track-info {
            position: absolute;
            top: 18%;
            left: 15%;
            color: #7f8c8d;
            font-size: 1.2vh;
            font-family: monospace;
        }

    </style>
</head>
<body>

    <div class="walkman-wm2">
        <div class="top-deck">
            <div class="logo-w">WALKMAN <span style="font-weight: 100; font-size: 1.5vh;">WM-2</span></div>
            <div class="led" id="power-led"></div>
        </div>

        <div id="track-info">NO TAPE DETECTED</div>

        <div class="window-frame">
            <div class="reel" id="reel-l"></div>
            <div class="reel" id="reel-r"></div>
        </div>

        <div class="eject-label" onclick="document.getElementById('folder-input').click()">LOAD FOLDER</div>

        <div class="button-cluster">
            <button class="wm2-btn play-btn" id="play">PLAY</button>
            <button class="wm2-btn" id="stop">STOP</button>
            <button class="wm2-btn" id="ff">F-FWD</button>
            <button class="wm2-btn" id="prev">PREV</button>
            <button class="wm2-btn" id="next">NEXT</button>
        </div>
    </div>

    <input type="file" id="folder-input" hidden webkitdirectory directory multiple>
    <audio id="audio"></audio>

    <script>
        const audio = document.getElementById('audio');
        const folderInput = document.getElementById('folder-input');
        const trackInfo = document.getElementById('track-info');
        const led = document.getElementById('power-led');
        const reels = document.querySelectorAll('.reel');

        let playlist = [];
        let cursor = 0;

        folderInput.onchange = (e) => {
            playlist = Array.from(e.target.files).filter(f => f.type.startsWith('audio/') || f.name.endsWith('.wav'));
            if(playlist.length > 0) {
                cursor = 0;
                loadTrack(cursor);
            }
        };

        function loadTrack(idx) {
            audio.src = URL.createObjectURL(playlist[idx]);
            trackInfo.innerText = `TRACK: ${idx + 1} / ${playlist.length}`;
            if (!audio.paused) audio.play();
        }

        document.getElementById('play').onclick = () => {
            if(!audio.src) return;
            audio.playbackRate = 1.0;
            audio.play();
            led.classList.add('led-on');
            reels.forEach(r => r.className = 'reel spinning');
        };

        document.getElementById('stop').onclick = () => {
            audio.pause();
            led.classList.remove('led-on');
            reels.forEach(r => r.className = 'reel');
        };

        document.getElementById('ff').onclick = () => {
            if(audio.paused) return;
            audio.playbackRate = (audio.playbackRate === 1.0) ? 4.0 : 1.0;
            reels.forEach(r => r.className = (audio.playbackRate > 1.0) ? 'reel spinning-fast' : 'reel spinning');
        };

        document.getElementById('next').onclick = () => {
            if(!playlist.length) return;
            cursor = (cursor + 1) % playlist.length;
            loadTrack(cursor);
            document.getElementById('play').click();
        };

        document.getElementById('prev').onclick = () => {
            if(!playlist.length) return;
            cursor = (cursor - 1 + playlist.length) % playlist.length;
            loadTrack(cursor);
            document.getElementById('play').click();
        };

        audio.onended = () => document.getElementById('next').click();
    </script>
</body>
</html>

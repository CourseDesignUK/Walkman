<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sony Quartz Professional</title>
    <style>
        :root {
            --metal-finish: linear-gradient(135deg, #bdc3c7 0%, #7f8c8d 50%, #bdc3c7 100%);
            --lcd-bg: #89b44a;
            --lcd-ink: #213502;
            --tape-brown: #3d2b1f;
        }

        body {
            background-color: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Main Chassis */
        .deck {
            width: 800px;
            height: 550px;
            background: var(--metal-finish);
            border-radius: 10px;
            position: relative;
            box-shadow: 0 40px 100px rgba(0,0,0,0.8);
            border: 1px solid #ffffff44;
            display: flex;
            flex-direction: column;
            padding: 30px;
            box-sizing: border-box;
        }

        /* Power LED */
        .power-section {
            position: absolute;
            top: 25px;
            right: 40px;
            text-align: right;
        }
        .led {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #400;
            border-radius: 50%;
            margin-left: 10px;
            transition: 0.3s;
        }
        .led-on { background: #ff4d00; box-shadow: 0 0 10px #ff4d00; }

        /* The Cassette Window */
        .window {
            width: 100%;
            height: 240px;
            background: #0a0a0a;
            border-radius: 8px;
            border: 12px solid #222;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 50px #000;
        }

        .reel-hub {
            width: 140px;
            height: 140px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }

        /* THE TAPE BULK - This grows/shrinks */
        .tape-bulk {
            position: absolute;
            background: var(--tape-brown);
            border-radius: 50%;
            z-index: 1;
            box-shadow: inset 0 0 10px #000;
        }
        #bulk-l { width: 130%; height: 130%; } /* Starts Full */
        #bulk-r { width: 40%; height: 40%; }   /* Starts Empty */

        .spindle {
            width: 60px;
            height: 60px;
            background: #111;
            border-radius: 50%;
            border: 5px dashed #444;
            z-index: 3;
        }

        .spinning { animation: rotate 3s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* LCD DISPLAY */
        .lcd {
            width: 350px;
            height: 100px;
            background: var(--lcd-bg);
            margin: 30px auto;
            border: 6px solid #111;
            box-shadow: inset 4px 4px 10px rgba(0,0,0,0.3);
            color: var(--lcd-ink);
            padding: 15px;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .lcd-line-1 { display: flex; justify-content: space-between; font-weight: bold; font-size: 18px; }
        .lcd-line-2 { font-size: 16px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
        
        /* Buttons */
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }

        .btn {
            background: #eee;
            border: 1px solid #999;
            padding: 10px 25px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 2px 4px 0 #555;
            text-transform: uppercase;
        }
        .btn:active { transform: translateY(2px); box-shadow: 0 0 0; }

        .eject { background: #666; color: white; border: none; }

        #file-input { display: none; }

    </style>
</head>
<body>

    <div class="deck">
        <div class="power-section">
            <span style="font-size: 10px; color: #333; font-weight: bold;">POWER</span>
            <div class="led" id="power-led"></div>
        </div>

        <h2 style="color: #444; margin: 0 0 20px 0; letter-spacing: 2px;">SONY</h2>

        <div class="window">
            <div class="reel-hub">
                <div class="tape-bulk" id="bulk-l"></div>
                <div class="spindle" id="spindle-l"></div>
            </div>

            <div class="reel-hub">
                <div class="tape-bulk" id="bulk-r"></div>
                <div class="spindle" id="spindle-r"></div>
            </div>
        </div>

        <div class="lcd">
            <div class="lcd-line-1">
                <span id="lcd-index">TAPE --/--</span>
                <span id="lcd-time">00:00</span>
            </div>
            <div class="lcd-line-2" id="lcd-name">READY...</div>
            <div style="font-size: 10px; letter-spacing: 2px;">■■■■■■■■■■■■■■■■■■■■■■■</div>
        </div>

        <div class="controls">
            <button class="btn eject" onclick="document.getElementById('file-input').click()">EJECT / LOAD</button>
            <button class="btn" id="play">PLAY</button>
            <button class="btn" id="stop">STOP</button>
            <button class="btn" id="prev">PREV</button>
            <button class="btn" id="next">NEXT</button>
        </div>
    </div>

    <input type="file" id="file-input" webkitdirectory directory multiple>
    <audio id="audio"></audio>

    <script>
        const audio = document.getElementById('audio');
        const fileInput = document.getElementById('file-input');
        const bulkL = document.getElementById('bulk-l');
        const bulkR = document.getElementById('bulk-r');
        const lcdTime = document.getElementById('lcd-time');
        const lcdName = document.getElementById('lcd-name');
        const lcdIndex = document.getElementById('lcd-index');
        const led = document.getElementById('power-led');
        const spindles = document.querySelectorAll('.spindle');

        let tracks = [];
        let cur = 0;

        fileInput.onchange = (e) => {
            tracks = Array.from(e.target.files).filter(f => f.type.startsWith('audio/') || f.name.endsWith('.wav'));
            if(tracks.length > 0) { cur = 0; load(cur); }
        };

        function load(i) {
            audio.src = URL.createObjectURL(tracks[i]);
            lcdName.innerText = tracks[i].name.toUpperCase();
            lcdIndex.innerText = `TAPE ${i+1}/${tracks.length}`;
            if (!audio.paused) audio.play();
        }

        document.getElementById('play').onclick = () => {
            if(!audio.src) return;
            audio.play();
            led.classList.add('led-on');
            spindles.forEach(s => s.classList.add('spinning'));
        };

        document.getElementById('stop').onclick = () => {
            audio.pause();
            led.classList.remove('led-on');
            spindles.forEach(s => s.classList.remove('spinning'));
        };

        document.getElementById('next').onclick = () => {
            if(!tracks.length) return;
            cur = (cur + 1) % tracks.length;
            load(cur);
            document.getElementById('play').click();
        };

        document.getElementById('prev').onclick = () => {
            if(!tracks.length) return;
            cur = (cur - 1 + tracks.length) % tracks.length;
            load(cur);
            document.getElementById('play').click();
        };

        audio.ontimeupdate = () => {
            // Time Display
            const m = Math.floor(audio.currentTime / 60);
            const s = Math.floor(audio.currentTime % 60);
            lcdTime.innerText = `${m}:${s.toString().padStart(2,'0')}`;

            // TAPE BULK LOGIC
            // Left shrinks from 130% to 40%
            // Right grows from 40% to 130%
            const progress = audio.currentTime / audio.duration;
            const shrink = 130 - (progress * 90);
            const grow = 40 + (progress * 90);

            bulkL.style.width = shrink + '%';
            bulkL.style.height = shrink + '%';
            
            bulkR.style.width = grow + '%';
            bulkR.style.height = grow + '%';
        };

        audio.onended = () => document.getElementById('next').click();
    </script>
</body>
</html>
